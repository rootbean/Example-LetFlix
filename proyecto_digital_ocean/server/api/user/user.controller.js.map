{"version":3,"sources":["api/user/user.controller.js"],"names":["index","create","show","req","res","findAll","then","status","json","users","catch","send","err","data","body","password","toString","next","userId","params","id","find","where","include","model","as","user","end"],"mappings":"AAAA;;;;;QAYgBA,K,GAAAA,K;QAaAC,M,GAAAA,M;QAgBAC,I,GAAAA,I;;AAvChB;;;;AACA;;AAEA;;;;AACA;;;;;;AAEA;;;;AAIO,SAASF,KAAT,CAAeG,GAAf,EAAoBC,GAApB,EAAyB;AAC9B,SAAO,YAAKC,OAAL,GACJC,IADI,CACC,iBAAS;AACbF,QAAIG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBC,KAArB;AACD,GAHI,EAIJC,KAJI,CAIE,eAAO;AACZN,QAAIG,MAAJ,CAAW,GAAX,EAAgBI,IAAhB,CAAqBC,GAArB;AACD,GANI,CAAP;AAOD;;AAED;;;AAGO,SAASX,MAAT,CAAgBE,GAAhB,EAAqBC,GAArB,EAA0B;;AAE/B,MAAIS,OAAOV,IAAIW,IAAf;AACAD,OAAKE,QAAL,GAAgB,mBAAOZ,IAAIW,IAAJ,CAASC,QAAhB,EAA0BC,QAA1B,CAAmC,KAAnC,CAAhB;AACA,SAAO,YAAKf,MAAL,CAAYY,IAAZ,EACJP,IADI,CACC,gBAAQ;AACZ,WAAOF,IAAIG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,eAArB,CAAP;AACD,GAHI,EAIJE,KAJI,CAIE,eAAO;AACZN,QAAIG,MAAJ,CAAW,GAAX,EAAgBI,IAAhB,CAAqBC,GAArB;AACD,GANI,CAAP;AAOD;;AAED;;;AAGO,SAASV,IAAT,CAAcC,GAAd,EAAmBC,GAAnB,EAAwBa,IAAxB,EAA8B;AACnC,MAAIC,SAASf,IAAIgB,MAAJ,CAAWC,EAAxB;;AAEA,SAAO,YAAKC,IAAL,CAAU;AACfC,WAAO,EAAEF,IAAIF,MAAN,EADQ;AAEfK,aAAS,CACP,EAAEC,0BAAF,EAAuBC,IAAI,gBAA3B,EADO;AAFM,GAAV,EAMJnB,IANI,CAMC,gBAAQ;AACZ,QAAG,CAACoB,IAAJ,EAAU,OAAOtB,IAAIG,MAAJ,CAAW,GAAX,EAAgBoB,GAAhB,EAAP;;AAEVvB,QAAII,IAAJ,CAASkB,IAAT;AACD,GAVI,EAWJhB,KAXI,CAWE;AAAA,WAAOO,KAAKL,GAAL,CAAP;AAAA,GAXF,CAAP;AAYD","file":"user.controller.js","sourcesContent":["'use strict';\n\nimport sha512 from 'sha512';\nimport {User} from '../../sqldb';\nimport {FavoriteShow} from '../../sqldb';\nimport config from '../../config/environment';\nimport jwt from 'jsonwebtoken';\n\n/**\n * Get list of users\n * restriction: 'admin'\n */\nexport function index(req, res) {\n  return User.findAll()\n    .then(users => {\n      res.status(200).json(users);\n    })\n    .catch(err => {\n      res.status(500).send(err);\n    });\n}\n\n/**\n * Creates a new user\n */\nexport function create(req, res) {\n\n  let data = req.body;\n  data.password = sha512(req.body.password).toString('hex');\n  return User.create(data)\n    .then(user => {\n      return res.status(201).json('Created user!');\n    })\n    .catch(err => {\n      res.status(500).send(err);\n    });\n}\n\n/**\n * Get a single user\n */\nexport function show(req, res, next) {\n  var userId = req.params.id;\n\n  return User.find({\n    where: { id: userId },\n    include: [\n      { model: FavoriteShow, as: 'favoritesShows'}\n    ]\n  })\n    .then(user => {\n      if(!user) return res.status(404).end();\n  \n      res.json(user);\n    })\n    .catch(err => next(err));\n}"]}